(this.webpackJsonpbldr=this.webpackJsonpbldr||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(4),r=a.n(i),o=(a(14),a(2)),s=a(1),c=a(5),u=a(6),d=a(8),h=a(7),m=function(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){e.index===e.currentLine&&t.current.focus()}),[e.index,e.currentLine]),l.a.createElement("span",{className:"line ".concat(e.lineValid?"valid":"invalid")},l.a.createElement("textarea",{ref:t,key:e.index,contentEditable:"true",suppressContentEditableWarning:!0,onChange:function(t){return e.handleLineChange(t,e.index)},onKeyDown:function(t){return e.handleKeyDown(t,e.index)},onClick:function(t){return e.handleClick(t,e.index)},onInput:function(t){return e.autoresize(t)},placeholder:e.placeholderLine,value:e.line?e.line:"",onMouseOver:function(t){return e.handleMouseover(e.index)},onMouseOut:function(t){return e.handleMouseOut(e.index)}}),l.a.createElement("h4",{className:"counter"}," ",e.syllableCount," / ",e.syllableLimit))},y=function(e){var t=e.lines,a=Object(s.a)({},e.exampleHaiku);return t&&t.length?t.map((function(t,n){return l.a.createElement(m,{className:"line",lineValid:e.syllableCounts[n]===e.syllableLimits[n],key:n,line:t,placeholderLine:a[n],currentLine:e.currentLine,syllableLimit:e.syllableLimits[n],syllableCount:e.syllableCounts[n],index:n,handleKeyDown:e.handleKeyDown,handleClick:e.handleClick,autoresize:e.autoresize,handleLineChange:e.handleLineChange,handleMouseover:e.handlePlaceholderMouseover,handleMouseOut:e.handlePlaceholderMouseout})})):null},p=function(e){return l.a.createElement("button",{onClick:e.handleClick,className:e.buttonStyle},e.value)},v=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement(p,{handleClick:e.handleContinue,buttonStyle:"continue",value:e.continueText||"Continue"}),l.a.createElement(p,{handleClick:e.handleCancel,buttonStyle:"cancel",value:e.cancelText||"Cancel"}))},g=function(e){var t=e.currentWord,a=t&&"text"in t&&"syllables"in t,n=t&&"activeEdit"in t&&t.activeEdit;if(!a&&!n)return null;var i=e.currentWord.syllables;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"currentWord"},l.a.createElement("h1",{className:"currentWordDisplay"},"".concat(a?t.text:"")),l.a.createElement("span",{onMouseEnter:function(t){return e.viewOriginalWord(!0)},onMouseLeave:function(t){return e.viewOriginalWord(!1)}},e.currentWord.edited?l.a.createElement("button",{className:"asterisk"},"*"):null,e.displayOriginalWord?l.a.createElement("span",{className:"originalWord"},l.a.createElement("span",null," This word was edited (by you). Here is the original:"),l.a.createElement("br",null),l.a.createElement("span",null,t.original?t.original.syllables:null," syllables"),l.a.createElement("br",null),l.a.createElement("span",null,t.original?t.original.definition:null),l.a.createElement(p,{value:"Reset word to original",handleClick:e.handleCurrentWordReset})):null),l.a.createElement("span",{className:"currentWordSyllables"},l.a.createElement("textarea",{className:"currentWordSyllableCount",onChange:function(t){return e.handleSyllableChange(t)},value:i}),l.a.createElement("textarea",{className:"currentWordSyllableText",disabled:!0,value:" syllable".concat(i>1||0===i?"s":"")})),e.displaySyllableUpdate?l.a.createElement(v,{continueText:"Update",cancelText:"Cancel",handleContinue:e.continueSyllableUpdate,handleCancel:e.cancelSyllableUpdate}):null,a&&"definition"in t?l.a.createElement("textarea",{className:"currentDefinition autoresize",value:t.definition,onChange:function(t){return e.handleDefinitionChange(t)},onInput:function(t){return e.autoresize(t)}}):null,e.displayDefinitionUpdate?l.a.createElement(v,{continueText:"Update",cancelText:"Cancel",handleContinue:e.continueDefinitionUpdate,handleCancel:e.cancelDefinitionUpdate}):null,e.displayWordResetButton?l.a.createElement(p,{handleClick:e.handleResetClick,buttonStyle:"recycle",value:"Reset syllable count & definition"}):null))},f=function(e){return l.a.createElement("div",{className:"title"},l.a.createElement("span",null,l.a.createElement("span",{className:"underline"},"title"),":"),l.a.createElement("textarea",{className:"title",value:e.title,onChange:function(t){return e.handleTitleChange(t.target.value,e.currentPoemIndex)}}))},b=function(e){var t=e.poem;if(!t)return null;var a=t.activeEdit?t.activeEdit:t.lines;console.log("PoemBuilder: lines: ".concat(a));t.valid;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"poem"},t?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row"},l.a.createElement(f,{title:t?t.title:"",handleTitleChange:e.handleTitleChange,edited:e.titleEdited}),e.poemIsEmpty?null:l.a.createElement(l.a.Fragment,null,l.a.createElement(p,{handleClick:e.handleSavePoem,value:"Save & create new poem"}),l.a.createElement(p,{handleClick:e.handleResetPoem,value:"Reset"}))),l.a.createElement("div",{className:"lines"},l.a.createElement(y,{handleKeyDown:e.handleKeyDown,handleClick:e.handleClick,lines:a,syllableLimits:e.criteria.syllableLimits,syllableCounts:e.syllableCounts,exampleHaiku:e.criteria.exampleHaiku,autoresize:e.autoresize,currentLine:e.currentLine,handleLineChange:e.handleLineChange,handlePlaceholderMouseover:e.handlePlaceholderMouseover,handlePlaceholderMouseout:e.handlePlaceholderMouseout}),l.a.createElement("hr",{className:"divider"}))):null),t&&!e.poemIsEmpty?l.a.createElement(l.a.Fragment,null,e.valid?l.a.createElement("div",null,l.a.createElement("h1",null,"This haiku is valid!")):null,l.a.createElement(g,{currentWord:e.currentWord,handleSyllableChange:e.handleSyllableChange,displaySyllableUpdate:e.displaySyllableUpdate,continueSyllableUpdate:e.continueSyllableUpdate,cancelSyllableUpdate:e.cancelSyllableUpdate,autoresize:e.autoresize,handleResetClick:e.handleResetClick,handleCurrentWordChange:e.handleCurrentWordChange,handleDefinitionChange:e.handleDefinitionChange,continueDefinitionUpdate:e.continueDefinitionUpdate,cancelDefinitionUpdate:e.cancelDefinitionUpdate,displayDefinitionUpdate:e.displayDefinitionUpdate,viewOriginalWord:e.viewOriginalWord,displayOriginalWord:e.displayOriginalWord,handleCurrentWordReset:e.handleCurrentWordReset})):null)},E=function(e){var t=e.lines&&e.lines.length?e.lines.map((function(e,t){return l.a.createElement("span",{key:t},l.a.createElement("span",null,e),l.a.createElement("br",null))})):null;return e.lines&&e.lines.length>0?l.a.createElement("span",{onClick:e.handleClick},t):null},C=function(e){if(!e.history||!e.history.length)return null;var t=Object(o.a)(e.history)[e.currentPoemIndex],a=(!!t&&t.valid,t.activeEdit?Object(s.a)({},t.activeEdit):t.lines);return l.a.createElement("div",{className:"history"},e.history.length?e.history.map((function(t,n){var i=n===e.currentPoemIndex;return l.a.createElement("span",{key:n},l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{disabled:i,className:"poemHistoryButton",key:n,onClick:function(t){return e.togglePoemHistory(n)}},i?l.a.createElement("h4",null,l.a.createElement("strong",null,t.title)):l.a.createElement("h4",null,t.title),l.a.createElement("br",null),l.a.createElement(E,{title:t.title,lines:a,className:"miniPoem",index:n}),i?l.a.createElement("span",null,"*",l.a.createElement("sub",null,"active poem")):null)))})):l.a.createElement("div",null,"No poems"))},S=function(e){var t=e.buttonNames;return l.a.createElement("div",{className:"nav"},Object.keys(t).map((function(a,n){return l.a.createElement("button",{className:"history"===a?"selected":null,key:n,onClick:function(t){return e.handleClick(a)}},t[a])})))},W="https://https://poem-builder.herokuapp.com",O=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).toggleView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e&&e in n.state.views)if(e===n.state.views.history)n.setState({displayHistory:!n.state.displayHistory});else{if(e===n.state.activeView)return;n.setState({activeView:e})}},n.addWordToMap=function(e,t){var a=new Map(n.state.map);void 0!==a.get(e)?t(a.get(e)):n.lookupWord(e,(function(l){n.setState({map:a.set(e,l)}),t(l)}))},n.autoresize=function(e){var t=e.target;t.style.height="auto",t.style.height=t.scrollHeight+"px",t.scrollTop=t.scrollHeight,window.scrollTo(window.scrollLeft,t.scrollTop+t.scrollHeight)},n.cancelWarning=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n.state.currentWord&&n.state.currentWord.activeEdit&&n.updateCurrentWord(null,t,a),n.setState({displayWarning:!1})},n.continueUpdate=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(n.state.currentWord&&n.state.currentWord.activeEdit){var l,i=Object(s.a)({},n.state.currentWord),r=t?n.state.currentWord.activeEdit.edit.syllables:i.syllables,o=a?n.state.currentWord.activeEdit.edit.definition:i.definition,c=Object(s.a)(Object(s.a)({},i),{},{syllables:r,definition:o,original:Object(s.a)({},i),edited:!0,activeEdit:!1}),u=new Map(n.state.map);u.delete(i.text),u.set(i.text,c);var d=n.state.history.map((function(e,t){return t===n.state.currentPoemIndex?(l=n.validatePoem(),Object(s.a)(Object(s.a)({},e),{},{valid:l})):e}));t&&n.cancelWarning(n.state.displaySyllableUpdate,!0,!1),a&&n.cancelWarning(n.state.displayDefinitionUpdate,!1,!0),n.updateSyllableCounts(),n.setState({map:u,displaySyllableUpdate:!1,currentWord:c,history:d,valid:l})}},n.getSyllableCount=function(e){var t=new Map(n.state.map).get(e);return t?t.syllables:0},n.handleClick=function(e,t){var a="";if(window.getSelection().modify&&window.getSelection){var l=e.target.selectionStart,i=e.target.selectionEnd,r=window.getSelection();r.isCollapsed?(r.modify("move","forward","character"),r.modify("move","backward","word"),r.modify("extend","forward","word"),a=r.toString(),r.modify("move","forward","character")):a=r.toString(),e.target.setSelectionRange(l,i)}var o=n.state.map.get(a);void 0===o?n.updateCurrentWord(a):n.setState({currentWord:Object(s.a)(Object(s.a)({},o),{},{edited:!1})}),n.setState({currentLine:t})},n.handleCreateNewPoem=function(){var e,t=Object(s.a)({},n.createPoem());e=n.state.history?[].concat(Object(o.a)(n.state.history),[t]):[t],n.setState({history:e,currentPoemIndex:e.length?e.length-1:0,poemIsEmpty:!0,activeView:n.state.views.poemBuilder})},n.handleCurrentWordChange=function(e){n.updateCurrentWord(e.target.value)},n.handleCurrentWordReset=function(){n.updateCurrentWord(n.state.currentWord.original.text)},n.handleKeyDown=function(e){var t;switch(e.key){case"Enter":e.preventDefault();break;case"ArrowDown":e.preventDefault(),t=Object(s.a)({},n.state.currentLine),++t<n.state.lineCount&&n.setState({currentLine:t});break;case"ArrowUp":e.preventDefault(),t=Object(s.a)({},n.state.currentLine),--t>=0&&n.setState({currentLine:t});break;default:return}},n.handleLineChange=function(e,t){var a=e.target.selectionStart,l=e.target.selectionEnd,i=e.target.value,r=e.target.value.slice(0,e.target.selectionEnd).split(" "),c=r[r.length-1];n.updateCurrentWord(c);var u=Object(o.a)(n.state.history)[n.state.currentPoemIndex],d=n.state.history.map((function(e,a){if(a===n.state.currentPoemIndex){var l=Object(o.a)(e.activeEdit);return l||(l=Array(n.state.lineCount).fill("")),l[t]=i,Object(s.a)(Object(s.a)({},e),{},{activeEdit:l})}return Object(s.a)(Object(s.a)({},e),{},{activeEdit:null})})),h=u.activeEdit&&u.activeEdit.length?u.activeEdit:u.lines;n.setState({history:d,poemIsEmpty:n.isPoemEmpty(h)}),n.validatePoem(),e.target.setSelectionRange(a,l)},n.handlePlaceholderMouseout=function(e){n.state.exampleHaiku&&n.setState({exampleHaiku:n.state.exampleHaiku.map((function(t,a){return e===a?n.state.exampleHaikuOriginal[a]:t}))})},n.handlePlaceholderMouseover=function(e){n.state.exampleHaiku&&n.setState({exampleHaiku:n.state.exampleHaiku.map((function(t,a){return a===e?n.state.placeholders[a]:n.state.exampleHaikuOriginal[a]}))})},n.handleResetClick=function(){n.updateCurrentWord(),n.setState({originalWordWarning:!1})},n.handleResetPoem=function(){n.setState({history:Object(o.a)(n.state.history).splice(n.state.currentPoemIndex,1,n.createPoem()),poemIsEmpty:!0})},n.handleSavePoem=function(){var e=Object(o.a)(n.state.history).splice(n.state.currentPoemIndex,1).find((function(e){return!0}));if(e&&e.lines){var t=Object(o.a)(n.state.history).map((function(e,t){return t===n.state.currentPoemIndex?(e.lines=Object(o.a)(e.activeEdit),e.activeEdit=null,e):e}));n.setState({history:t,currentPoemIndex:t.length-1}),n.handleCreateNewPoem()}else n.setState({poemIsEmpty:!0})},n.handleDefinitionChange=function(e){e.target.value&&e.target.value!==n.state.currentWord.definition?n.setState({displayDefinitionUpdate:!0}):n.setState({displayDefinitionUpdate:!1}),n.setState({currentWord:Object(s.a)(Object(s.a)({},n.state.currentWord),{},{activeEdit:Object(s.a)(Object(s.a)({},n.state.activeEdit),{},{definition:!0,edit:Object(s.a)(Object(s.a)({},n.state.currentWord),{},{definition:e.target.value})})})})},n.handleSyllableChange=function(e){e.target.value&&e.target.value!==n.state.currentWord.syllables?n.setState({displaySyllableUpdate:!0}):n.setState({displaySyllableUpdate:!1}),n.setState({currentWord:Object(s.a)(Object(s.a)({},n.state.currentWord),{},{activeEdit:Object(s.a)(Object(s.a)({},n.state.activeEdit),{},{syllables:!0,edit:Object(s.a)(Object(s.a)({},n.state.currentWord),{},{syllables:e.target.value?parseInt(e.target.value):""})})})})},n.handleTitleChange=function(e){n.setState({history:n.state.history.map((function(t,a){return a===n.state.currentPoemIndex?Object(s.a)(Object(s.a)({},t),{},{title:e}):t}))})},n.incrementCounter=function(){n.setState({counter:n.state.counter+1})},n.isPoemEmpty=function(e){return!e||!e.length||e.reduce((function(e,t){return e&&!t}),!0)},n.lookupWord=function(e,t){for(var a=arguments.length,n=new Array(a>2?a-2:0),l=2;l<a;l++)n[l-2]=arguments[l];if(!e&&!t)return console.log("lookupWord --\x3e word: ".concat(e)),null;var i="".concat(W,"/wordAPI/").concat(e);fetch(i).then((function(e){return e.json()})).then((function(a){var l={text:e,definition:a.definition,syllables:a.syllables,edited:a.edited,activeEdit:a.activeEdit};t(l,n)})).catch((function(e){return e}))},n.togglePoemHistory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e!==n.state.currentPoemIndex){var t=Object(o.a)(n.state.history)[n.state.currentPoemIndex];if(console.log("togglePoemHistory, history1: ".concat(JSON.stringify(n.state.history))),console.log("togglePoemHistory, currentPoem: ".concat(JSON.stringify(t))),!t)return null;var a=t.activeEdit&&t.activeEdit.length?t.activeEdit:t.lines;console.log("togglePoemHistory, lines: ".concat(JSON.stringify(t.activeEdit))),console.log("togglePoemHistory, index: ".concat(JSON.stringify(n.state.currentPoemIndex))),console.log("togglePoemHistory, [...history]: ".concat(JSON.stringify(Object(o.a)(n.state.history))));var l=Object(s.a)(Object(s.a)({},Object(o.a)(n.state.history)[n.state.currentPoemIndex]),{},{lines:t.activeEdit});console.log("togglePoemHistory, newPoem: ".concat(JSON.stringify(l)));var i=Object(o.a)(n.state.history);i.splice(n.state.currentPoemIndex,1,l),console.log("togglePoemHistory, history3: ".concat(JSON.stringify(i))),n.setState({history:i,currentPoemIndex:e,poemIsEmpty:n.isPoemEmpty(a)})}},n.updateCurrentWord=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(s.a)({},n.state.currentWord);(t||e)&&(e||(e="text"in t?t.text:""),n.addWordToMap(e,(function(e){n.setState({currentWord:Object(s.a)(Object(s.a)({},e),{},{activeEdit:!1})})})))},n.getCurrentPoem=function(){return Object(o.a)(n.state.history).splice(n.state.currentPoemIndex,1).find((function(e){return!0}))},n.updateSyllableCounts=function(){var e=n.getCurrentPoem();if(!e||!e.lines||!e.lines.length||!e.activeEdit||!e.activeEdit.length)return null;var t=(e.activeEdit.length?e.activeEdit:e.lines).map((function(e){return e?e.split(" ").reduce((function(e,t){var a=n.state.map.get(t);return a&&"syllables"in a&&void 0!==a.syllables?e+a.syllables:e+0}),0):0}));return n.setState({syllableCounts:t}),t},n.validatePoem=function(e){var t=n.updateSyllableCounts();if(!e)return!1;for(var a=0;a<e.length;a++)if(t[a]!==n.state.criteria.syllableLimits[a])return n.setState({valid:!1}),!1;return n.setState({valid:!0}),!0},n.viewOriginalWord=function(e){n.setState({originalWordWarning:e})},n.state={counter:0,currentPoemIndex:0,currentWord:null,criteria:{lineCount:3,syllableLimits:[5,7,5],placeholders:["Line 1 uses 5 syllables","Line 2 uses 7 syllables","Line 3 uses 5 syllables"],exampleHaiku:["haikus are easy","but sometimes they don't make sense","refrigerator"],exampleHaikuOriginal:["haikus are easy","but sometimes they don't make sense","refrigerator"]},history:null,map:new Map,poemIsEmpty:!0,syllableCounts:[0,0,0],displayHistory:!1,activeView:null,views:{poemBuilder:"poemBuilder",myWords:"myWords",help:"help",selfDestruct:"selfDestruct",history:"history"},viewNames:{poemBuilder:"Current Build",myWords:"Word Bank",help:"Help",selfDestruct:"Self Destruct",history:"My Poems"}},n}return Object(u.a)(a,[{key:"createPoem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Haiku",a=e||this.state.counter;this.incrementCounter();var n="".concat(t," ").concat(a),l={title:n,lines:Array(3).fill(""),lineCount:3,type:"haiku",activeEdit:Array(3).fill(""),valid:!1};return l}},{key:"createWord",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n={text:e,syllables:t,definition:a,activeEdit:{syllables:!1,definition:!1,edit:{}},edited:!1};return Object(s.a)({},n)}},{key:"renderSwitch",value:function(e){var t=this,a={};this.state.history&&(a=Object(o.a)(this.state.history)[this.state.currentPoemIndex]);var n=this.state.views;switch(e){case null:return null;case n.poemBuilder:return l.a.createElement(l.a.Fragment,null,l.a.createElement(b,{syllableCounts:this.state.syllableCounts,poem:a,valid:this.state.valid,poemIsEmpty:this.state.poemIsEmpty,map:this.state.map,criteria:this.state.criteria,lineCount:this.state.lineCount,currentPoemIndex:this.state.currentPoemIndex,handleKeyDown:this.handleKeyDown,handleClick:this.handleClick,currentWord:this.state.currentWord,handleSyllableChange:this.handleSyllableChange,displaySyllableUpdate:this.state.displaySyllableUpdate,displayDefinitionUpdate:this.state.displayDefinitionUpdate,autoresize:this.autoresize,currentLine:this.state.currentLine,handleResetClick:this.handleResetCurrentWordClick,handleLineChange:this.handleLineChange,handleCurrentWordChange:this.handleCurrentWordChange,handleDefinitionChange:this.handleDefinitionChange,continueDefinitionUpdate:function(){return t.continueUpdate(t.state.displayDefinitionUpdate,!1,!0)},continueSyllableUpdate:function(){return t.continueUpdate(t.state.displaySyllableUpdate,!0,!1)},cancelDefinitionUpdate:function(){return t.cancelWarning(t.state.displayDefinitionUpdate,!1,!0)},cancelSyllableUpdate:function(){return t.cancelWarning(t.state.displaySyllableUpdate,!0,!1)},handleSavePoem:this.handleSavePoem,handleResetPoem:this.handleResetPoem,viewOriginalWord:this.viewOriginalWord,displayOriginalWord:this.state.displayOriginalWord,handleCurrentWordReset:this.handleCurrentWordReset,handleTitleChange:this.handleTitleChange,titleEdited:this.state.titleEdited,handlePlaceholderMouseover:this.handlePlaceholderMouseover,handlePlaceholderMouseout:this.handlePlaceholderMouseout,createPoem:this.createPoem,updateSyllableCounts:this.updateSyllableCounts}),this.state.displayHistory?l.a.createElement(C,{history:this.state.history,currentPoemIndex:this.state.currentPoemIndex,togglePoemHistory:this.togglePoemHistory,poemIsEmpty:this.state.poemIsEmpty}):null);case n.history:case n.myWords:case n.help:case n.selfDestruct:break;default:return}}},{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,this.state.activeView?l.a.createElement(l.a.Fragment,null,l.a.createElement(S,{buttonNames:this.state.viewNames,handleClick:this.toggleView,handleMouseover:this.handleMouseoverHistory,handleMouseout:this.handleMouseoutHistory}),this.renderSwitch(this.state.activeView)):l.a.createElement(p,{buttonStyle:"startButton",handleClick:this.handleCreateNewPoem,value:"Build!",displayHistory:this.state.displayHistory}))}}]),a}(l.a.Component);r.a.render(l.a.createElement(O,null),document.getElementById("root"))},9:function(e,t,a){e.exports=a(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.1ead1b03.chunk.js.map